var z=Object.defineProperty;var H=(o,e,t)=>e in o?z(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var r=(o,e,t)=>(H(o,typeof e!="symbol"?e+"":e,t),t),I=(o,e,t)=>{if(!e.has(o))throw TypeError("Cannot "+t)};var c=(o,e,t)=>{if(e.has(o))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(o):e.set(o,t)};var l=(o,e,t)=>(I(o,e,"access private method"),t);const K=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const E of n.addedNodes)E.tagName==="LINK"&&E.rel==="modulepreload"&&s(E)}).observe(document,{childList:!0,subtree:!0});function t(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerpolicy&&(n.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?n.credentials="include":i.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(i){if(i.ep)return;i.ep=!0;const n=t(i);fetch(i.href,n)}};K();var m,k,p,y,b,S,v,V,f,A,P,F;const a=class{constructor(e=`.${a.template_placeholder}`,t=document){c(this,m);c(this,p);c(this,b);c(this,v);c(this,f);c(this,P);r(this,"element");r(this,"style");r(this,"classList");const s=l(this,f,A).call(this,e,t);l(this,p,y).call(this,s)?l(this,b,S).call(this,s):this.element=s,l(this,m,k).call(this)}dot(...e){for(let t of e){const s=t[0],i=t[1],n=t[2];(t.length>2&&i!=""||t.length==2)&&this.text(s,i),t.length==3&&this.attr(s,n)}return this}DOM(e=`.${a.template_placeholder}`){return new a(e,this.element)}q(e){return l(this,f,A).call(this,e,this.element)}a(e){return this.element.querySelectorAll(e)}static fromElement(e){var s;const t=new a;return t.element=e,l(s=t,m,k).call(s),t}attr(e,t){this.element.querySelectorAll(e).forEach(s=>l(this,P,F).call(this,s,t))}text(e,t){this.element.querySelectorAll(e).forEach(s=>s.textContent=t)}};let d=a;m=new WeakSet,k=function(){var e,t;this.style=(e=this.element)==null?void 0:e.style,this.classList=(t=this.element)==null?void 0:t.classList},p=new WeakSet,y=function(e){return e==null?void 0:e.classList.contains(a.template_placeholder)},b=new WeakSet,S=function(e){var s;const t=(s=e.lazyParent)!=null?s:e.parentElement;this.element=e.cloneNode(!0),t.append(this.element),l(this,v,V).call(this,e)},v=new WeakSet,V=function(e){l(this,p,y).call(this,this.element)&&this.element.classList.remove(a.template_placeholder),e.lazyParent||(e.lazyParent=e.parentElement),l(this,p,y).call(this,e)&&e.remove()},f=new WeakSet,A=function(e,t){a.CACHE.has(t)||a.CACHE.set(t,new Map);const s=a.CACHE.get(t);return s.has(e)||s.set(e,t.querySelector(e)),s.get(e)},P=new WeakSet,F=function(e,t){for(let s in t){const i=[s,t[s]];a.events.includes(s)?e.addEventListener(...i):e.nodeName==="INPUT"&&s==="value"?e.value=t[s]:e.setAttribute(...i)}},r(d,"template_placeholder","lazydom"),r(d,"events",["click","change"]),r(d,"CACHE",new Map);const h=class{constructor(e){this.api_key=e}buildUrl(e){if(!e)return h.sample_url;const t=new URL(h.yt_url);return t.searchParams.set("part","snippet,id"),t.searchParams.set("channelId",h.mair_cid),t.searchParams.set("maxResults","20"),t.searchParams.set("order","date"),t.searchParams.set("key",e),t}async downloadData(){var e;return(e=await this.downloadDataFb())!=null?e:await this.downloadDataFb(!0)}async downloadDataFb(e=!1){e&&console.warn("Fallback to fetch prepared sample data...");const t=e?h.sample_url:this.buildUrl(this.api_key);console.log("Trying to fetch data from ",t);const s=await fetch(t);return s.ok?await s.json():null}};let u=h;r(u,"sample_url","MaiRChannel.json"),r(u,"yt_url","https://youtube.googleapis.com/youtube/v3/search"),r(u,"mair_cid","UCsiKFVHkQSMlSe0vaCG0anw");var g,q,L,N,C,x;const U=class{constructor(){c(this,g);c(this,L);c(this,C);r(this,"featured_video",new d("#app .featured"));r(this,"video_bar",new d);r(this,"video_list");r(this,"selectVideo",e=>{console.log({v:e}),console.log("url: ",e.url),this.featured_video.dot(["a.video iframe","",{src:e.url}],["p.title",e.title],["p.description",e.desc])});this.yt=new u(this.getKey()),this.asyncProcedures()}async asyncProcedures(){await l(this,g,q).call(this),await l(this,L,N).call(this),await l(this,C,x).call(this)}appendVideo(e){this.video_bar.DOM().dot(["a.title",e.title],["a.thumbnail > img","",{src:e.thumb,alt:e.title}],["a","",{click:s=>this.selectVideo(e)}])}dataParser(e){const t=[];for(let s of e.items)t.push(this.videoParser(s));return t}videoParser(e){return{vid:e.id.videoId,title:e.snippet.title,desc:e.snippet.description,thumb:e.snippet.thumbnails.high.url,url:this.ytUrl(e.id.videoId)}}ytUrl(e){const t=/\$\{vid\}/;return U.youtube_url.replace(t,e)}getKey(){return new URL(document.location).searchParams.get("key")}};let w=U;g=new WeakSet,q=async function(){const e=await this.yt.downloadData();this.video_list=this.dataParser(e),console.log({json_data:e})},L=new WeakSet,N=async function(){for(let e of this.video_list)this.appendVideo(e)},C=new WeakSet,x=async function(){this.selectVideo(this.video_list[0])},r(w,"youtube_url","https://www.youtube-nocookie.com/embed/${vid}");new w;
